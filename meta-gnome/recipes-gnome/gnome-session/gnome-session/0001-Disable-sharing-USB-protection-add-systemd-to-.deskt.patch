From d85a2f316b8bba505d24173484e43bd5abededa0 Mon Sep 17 00:00:00 2001
From: David McKinney <mckinney@subgraph.com>
Date: Fri, 3 Jul 2020 12:09:35 +0000
Subject: [PATCH] Disable sharing/USB protection, add --systemd to .desktops

---
 data/gnome-wayland.desktop.in.in | 4 +++-
 data/gnome-xorg.desktop.in.in    | 2 +-
 data/gnome.desktop.in.in         | 2 +-
 data/gnome.session.desktop.in.in | 2 +-
 4 files changed, 6 insertions(+), 4 deletions(-)

diff --git a/data/gnome-wayland.desktop.in.in b/data/gnome-wayland.desktop.in.in
index 516c211..14b5f5a 100644
--- a/data/gnome-wayland.desktop.in.in
+++ b/data/gnome-wayland.desktop.in.in
@@ -1,7 +1,9 @@
 [Desktop Entry]
 Name=GNOME
 Comment=This session logs you into GNOME
-Exec=@bindir@/gnome-session
+Exec=@bindir@/gnome-session --systemd --session=gnome
 TryExec=@bindir@/gnome-session
 Type=Application
 DesktopNames=GNOME
+X-GDM-SessionRegisters=true
+
diff --git a/data/gnome-xorg.desktop.in.in b/data/gnome-xorg.desktop.in.in
index 9a76fac..40ec660 100644
--- a/data/gnome-xorg.desktop.in.in
+++ b/data/gnome-xorg.desktop.in.in
@@ -1,7 +1,7 @@
 [Desktop Entry]
 Name=GNOME on Xorg
 Comment=This session logs you into GNOME
-Exec=@bindir@/gnome-session
+Exec=@bindir@/gnome-session --systemd --session=gnome
 TryExec=@bindir@/gnome-session
 Type=Application
 DesktopNames=GNOME
diff --git a/data/gnome.desktop.in.in b/data/gnome.desktop.in.in
index 7eec1de..d83655e 100644
--- a/data/gnome.desktop.in.in
+++ b/data/gnome.desktop.in.in
@@ -1,7 +1,7 @@
 [Desktop Entry]
 Name=GNOME
 Comment=This session logs you into GNOME
-Exec=@bindir@/gnome-session
+Exec=@bindir@/gnome-session --systemd --session=gnome
 TryExec=@bindir@/gnome-session
 Type=Application
 DesktopNames=GNOME
diff --git a/data/gnome.session.desktop.in.in b/data/gnome.session.desktop.in.in
index 6c70f54..5841b97 100644
--- a/data/gnome.session.desktop.in.in
+++ b/data/gnome.session.desktop.in.in
@@ -1,3 +1,3 @@
 [GNOME Session]
 Name=GNOME
-RequiredComponents=org.gnome.Shell;org.gnome.SettingsDaemon.A11ySettings;org.gnome.SettingsDaemon.Color;org.gnome.SettingsDaemon.Datetime;org.gnome.SettingsDaemon.Housekeeping;org.gnome.SettingsDaemon.Keyboard;org.gnome.SettingsDaemon.MediaKeys;org.gnome.SettingsDaemon.Power;org.gnome.SettingsDaemon.PrintNotifications;org.gnome.SettingsDaemon.Rfkill;org.gnome.SettingsDaemon.ScreensaverProxy;org.gnome.SettingsDaemon.Sharing;org.gnome.SettingsDaemon.Smartcard;org.gnome.SettingsDaemon.Sound;org.gnome.SettingsDaemon.UsbProtection;org.gnome.SettingsDaemon.Wacom;org.gnome.SettingsDaemon.XSettings;
+RequiredComponents=org.gnome.Shell;org.gnome.SettingsDaemon.A11ySettings;org.gnome.SettingsDaemon.Color;org.gnome.SettingsDaemon.Datetime;org.gnome.SettingsDaemon.Housekeeping;org.gnome.SettingsDaemon.Keyboard;org.gnome.SettingsDaemon.MediaKeys;org.gnome.SettingsDaemon.Power;org.gnome.SettingsDaemon.PrintNotifications;org.gnome.SettingsDaemon.Rfkill;org.gnome.SettingsDaemon.ScreensaverProxy;org.gnome.SettingsDaemon.Smartcard;org.gnome.SettingsDaemon.Sound;org.gnome.SettingsDaemon.Wacom;org.gnome.SettingsDaemon.XSettings;
